![CI](https://github.com/arosyri/architecture-lab-4/actions/workflows/ci.yml/badge.svg)
# Горизонтальне масштабування програмних систем

## Опис

Цей проєкт реалізує балансувальник навантаження, який розподіляє HTTP-запити між кількома бекенд-серверами.  
Балансувальник підтримує перевірку "здоров'я" серверів (`/health`) та вибір сервера з найменшим трафіком (кількістю відданих байтів).  
Також є інтеграційні та юніт-тести для перевірки коректності роботи алгоритму.

---

## Структура

- `balancer` — балансувальник навантаження
- `server1`, `server2`, `server3` — бекенд-сервера з ендпоінтами `/health` та `/api/v1/some-data`
- `test` — контейнер для інтеграційного тестування балансувальника
- `docker-compose.yaml` — основний стек для запуску сервісів
- `docker-compose.test.yaml` — доповнення для запуску інтеграційних тестів
- `Dockerfile.test` — Dockerfile для контейнера з тестами

---

## Запуск локально

### Крок 1. Побудова образів

```bash
docker-compose build
```
### Крок 2. Запуск усіх сервісів

```bash
docker-compose up -d
```
### Крок 3. Перевірка роботи балансувальника через curl

```bash
curl -v http://localhost:8090/api/v1/some-data
```
Відповідь має містити заголовок lb-from із назвою сервера, який обробив запит.

## Запуск інтеграційних тестів

Запускаються балансувальник, бекенди та тестовий контейнер.

```bash
docker-compose -f docker-compose.yaml -f docker-compose.test.yaml up --exit-code-from test
```
Після завершення тести покажуть, що запити правильно розподіляються між серверами.

